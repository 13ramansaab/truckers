{
  "meta": {
    "project": "IFTA Mileage & Fuel Log",
    "date": "2025-08-17",
    "prepared_by": "Generated by Testsprite"
  },
  "product_overview": "IFTA Mileage & Fuel Log is a professional trucking mobile app built on React Native and Expo to assist truckers with IFTA compliance, trip tracking, fuel logging, and generating quarterly tax reports. The app integrates GPS tracking, receipt capture, subscription management, and detailed analytics to provide a comprehensive tool for managing trip and fuel data efficiently.",
  "core_goals": [
    "Provide accurate and reliable GPS-based trip tracking with configurable accuracy and background support.",
    "Enable easy and detailed fuel purchase logging including receipt capture and location data.",
    "Generate detailed quarterly IFTA reports with state-specific breakdowns, tax calculations, and export options in CSV and PDF formats.",
    "Offer a smooth onboarding experience explaining core features and facilitating subscription activation.",
    "Deliver a user-friendly dashboard summarizing current quarter statistics, trip status, and quick actions.",
    "Support user preferences including theme selection, unit system, and GPS accuracy settings.",
    "Ensure security, privacy, and compliance with IFTA audit and data retention standards."
  ],
  "key_features": [
    "User Authentication via Supabase with email/password sign-up and login.",
    "Onboarding carousel explaining key app functionalities and enabling trial activation.",
    "Subscription management through RevenueCat with free trial, monthly plan, and purchase restoration.",
    "GPS-enabled trip tracking with start, stop, real-time monitoring, background tracking, and GPS accuracy options.",
    "Fuel logging system supporting fuel volume, cost, date/time, GPS location, and receipt photo capture with history viewing and filtering.",
    "Quarterly IFTA reporting with state-by-state mileage and fuel breakdown, automatic tax computation, and export in CSV/PDF.",
    "Dashboard displaying overall statistics (mileage, fuel cost, MPG), current trip status, and quick action buttons.",
    "Settings for theme (Light/Dark/System), unit system (US/Metric), GPS accuracy, and account management.",
    "Offline capabilities with local SQLite storage and cloud sync.",
    "Error handling, form validation, and user-friendly navigation using a tab-based interface."
  ],
  "user_flow_summary": [
    "User signs up or logs in via email/password and optionally completes a 3-screen onboarding explaining the app features.",
    "User activates a free trial or manages subscription via RevenueCat to access full app functionality.",
    "User starts a trip with GPS tracking, monitored in real-time with configurable accuracy and background support.",
    "User stops the trip to calculate total mileage tracked during the session.",
    "User logs fuel purchases including gallons/liters, cost, date/time, location, and receipt photo.",
    "User views and filters past fuel entries for review or editing.",
    "User generates quarterly IFTA reports by selecting quarter and year, viewing state-by-state data, tax calculations, and exporting reports as CSV or PDF.",
    "User views the dashboard displaying current quarter stats, active trip status, and uses quick actions for common tasks.",
    "User adjusts settings for theme preferences, unit system, GPS accuracy, and account management."
  ],
  "validation_criteria": [
    "Authentication system reliably supports email/password sign-up, login, and session management using Supabase.",
    "Trip tracking features start, stop, and record accurate GPS data with less than 10 meters error and support background tracking.",
    "Fuel logging correctly stores and retrieves fuel entries with all required metadata and receipt photos.",
    "Quarterly reports accurately compute mileage, fuel consumption, and IFTA taxes with export functionality producing valid CSV and PDF files.",
    "Subscription management supports free trial activation, monthly purchase, status checks, and purchase restoration with RevenueCat.",
    "Settings changes persist correctly and reflect in app behavior including theme, units, and GPS accuracy.",
    "Onboarding flow completes properly and gate access to subscription-protected features.",
    "Dashboard and analytics display real-time accurate statistics and trip status.",
    "App maintains acceptable performance benchmarks with response times under 2 seconds for core operations.",
    "All user personal and trip data stored securely and app complies with privacy and data retention policies."
  ],
  "code_summary": {
    "tech_stack": [
      "TypeScript",
      "React Native",
      "Expo",
      "SQLite",
      "Supabase",
      "RevenueCat",
      "Expo Router"
    ],
    "features": [
      {
        "name": "User Authentication",
        "description": "Email/password authentication system with Supabase backend",
        "files": [
          "components/AuthGate.tsx",
          "utils/auth.ts",
          "utils/supabase.ts"
        ],
        "api_doc": {
          "openapi": "3.0.0",
          "info": {
            "title": "User Authentication API",
            "version": "1.0.0"
          },
          "paths": {
            "/auth/signup": {
              "post": {
                "summary": "Create new user account",
                "requestBody": {
                  "content": {
                    "application/json": {
                      "schema": {
                        "type": "object",
                        "properties": {
                          "email": {
                            "type": "string"
                          },
                          "password": {
                            "type": "string"
                          }
                        }
                      }
                    }
                  }
                }
              }
            },
            "/auth/signin": {
              "post": {
                "summary": "Sign in existing user",
                "requestBody": {
                  "content": {
                    "application/json": {
                      "schema": {
                        "type": "object",
                        "properties": {
                          "email": {
                            "type": "string"
                          },
                          "password": {
                            "type": "string"
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      },
      {
        "name": "Trip Tracking System",
        "description": "GPS-based trip tracking with start/stop functionality and real-time location monitoring",
        "files": [
          "components/TripTracker.tsx",
          "utils/location.ts",
          "utils/database.ts",
          "types/index.ts"
        ],
        "api_doc": {
          "openapi": "3.0.0",
          "info": {
            "title": "Trip Tracking API",
            "version": "1.0.0"
          },
          "paths": {
            "/trip/start": {
              "post": {
                "summary": "Start a new trip with GPS tracking",
                "responses": {
                  "200": {
                    "description": "Trip started successfully"
                  }
                }
              }
            },
            "/trip/stop": {
              "post": {
                "summary": "Stop current trip and calculate mileage",
                "responses": {
                  "200": {
                    "description": "Trip stopped successfully"
                  }
                }
              }
            }
          }
        }
      },
      {
        "name": "Fuel Logging System",
        "description": "Fuel purchase logging with receipt photos, location data, and cost tracking",
        "files": [
          "app/(tabs)/fuel.tsx",
          "utils/database.ts",
          "components/FuelEntryForm.tsx"
        ],
        "api_doc": {
          "openapi": "3.0.0",
          "info": {
            "title": "Fuel Logging API",
            "version": "1.0.0"
          },
          "paths": {
            "/fuel/entry": {
              "post": {
                "summary": "Create new fuel entry",
                "requestBody": {
                  "content": {
                    "application/json": {
                      "schema": {
                        "type": "object",
                        "properties": {
                          "gallons": {
                            "type": "number"
                          },
                          "totalCost": {
                            "type": "number"
                          },
                          "location": {
                            "type": "object"
                          },
                          "date": {
                            "type": "string"
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      },
      {
        "name": "IFTA Reporting System",
        "description": "Quarterly IFTA reports with state-by-state breakdown, tax calculations, and export functionality",
        "files": [
          "app/(tabs)/quarter.tsx",
          "components/ExportButtons.tsx",
          "utils/database.ts"
        ],
        "api_doc": {
          "openapi": "3.0.0",
          "info": {
            "title": "IFTA Reporting API",
            "version": "1.0.0"
          },
          "paths": {
            "/reports/quarterly": {
              "get": {
                "summary": "Generate quarterly IFTA report",
                "parameters": [
                  {
                    "name": "quarter",
                    "in": "query",
                    "schema": {
                      "type": "integer"
                    }
                  },
                  {
                    "name": "year",
                    "in": "query",
                    "schema": {
                      "type": "integer"
                    }
                  }
                ]
              }
            },
            "/reports/export/csv": {
              "get": {
                "summary": "Export report as CSV"
              }
            },
            "/reports/export/pdf": {
              "get": {
                "summary": "Export report as PDF"
              }
            }
          }
        }
      },
      {
        "name": "Subscription Management",
        "description": "RevenueCat integration for subscription handling with free trial and monthly plans",
        "files": [
          "components/PaywallGate.tsx",
          "utils/iap.ts",
          "revenuecat-config.ts"
        ],
        "api_doc": {
          "openapi": "3.0.0",
          "info": {
            "title": "Subscription API",
            "version": "1.0.0"
          },
          "paths": {
            "/subscription/status": {
              "get": {
                "summary": "Get current subscription status"
              }
            },
            "/subscription/purchase": {
              "post": {
                "summary": "Purchase subscription"
              }
            },
            "/subscription/restore": {
              "post": {
                "summary": "Restore previous purchases"
              }
            }
          }
        }
      },
      {
        "name": "Settings & Preferences",
        "description": "User preferences including theme selection, unit system, GPS accuracy, and account management",
        "files": [
          "app/(tabs)/settings.tsx",
          "utils/prefs.ts",
          "utils/theme.ts"
        ],
        "api_doc": {
          "openapi": "3.0.0",
          "info": {
            "title": "Settings API",
            "version": "1.0.0"
          },
          "paths": {
            "/settings/theme": {
              "put": {
                "summary": "Update app theme preference"
              }
            },
            "/settings/units": {
              "put": {
                "summary": "Update unit system preference"
              }
            },
            "/settings/gps-accuracy": {
              "put": {
                "summary": "Update GPS accuracy preference"
              }
            }
          }
        }
      },
      {
        "name": "Onboarding System",
        "description": "User onboarding flow with feature explanation and trial activation",
        "files": [
          "components/OnboardingCarousel.tsx",
          "components/PaywallGate.tsx"
        ],
        "api_doc": {
          "openapi": "3.0.0",
          "info": {
            "title": "Onboarding API",
            "version": "1.0.0"
          },
          "paths": {
            "/onboarding/status": {
              "get": {
                "summary": "Get onboarding completion status"
              }
            },
            "/onboarding/complete": {
              "post": {
                "summary": "Mark onboarding as complete"
              }
            }
          }
        }
      },
      {
        "name": "Dashboard & Analytics",
        "description": "Home screen with current quarter statistics, trip status, and quick actions",
        "files": [
          "app/(tabs)/index.tsx",
          "utils/database.ts",
          "utils/theme.ts"
        ],
        "api_doc": {
          "openapi": "3.0.0",
          "info": {
            "title": "Dashboard API",
            "version": "1.0.0"
          },
          "paths": {
            "/dashboard/stats": {
              "get": {
                "summary": "Get current quarter statistics"
              }
            },
            "/dashboard/trip-status": {
              "get": {
                "summary": "Get current trip status"
              }
            }
          }
        }
      }
    ]
  }
}
